# 文件名: colbert/parameters.py

import torch

# 定义全局默认的计算设备。在 ColBERT 中，这通常是 CUDA 设备（GPU）。
DEVICE = torch.device("cuda")

# 定义一个在训练过程中需要保存的检查点（checkpoint）的迭代步数列表。
# 这允许在训练中断后从最近的检查点恢复，或用于后续的模型评估和分析。
SAVED_CHECKPOINTS = [
    # 每 10k 到 90k
    10*1000, 20*1000, 30*1000, 40*1000, 50*1000, 60*1000, 70*1000, 80*1000, 90*1000,
    # 每 25k
    25*1000, 50*1000, 75*1000,
    # 更大的间隔
    32*1000, 100*1000, 150*1000, 200*1000, 250*1000, 300*1000, 400*1000
]

# 转换为集合以提高查找效率并自动去重
SAVED_CHECKPOINTS = set(SAVED_CHECKPOINTS)